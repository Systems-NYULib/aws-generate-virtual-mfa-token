# aws-generate-virtual-mfa-token 
AWS Generates New MFA Token for CLI

As user trying to run cli commands in aws you will need to generate a new mfa token. Default token life is 12hrs. Once token is generated it will setup a new profile in your ~/.aws/credentials file under profile [mfa]. Make sure you dont already have that profile otherwise it will get overwritten. There are two options that get passed to the script, one is the user name you are currently using to get access through CLI, and second is the virtual token generated by your phone authenticator. You can run the script as many times as you like, it will just continue to update the [mfa] profile with newly generated tokens.

Help menu

    $ ./generate-mfa-cli-token.sh

Generate new MFA token

    $ ./generate-mfa-cli-token.sh <user> <token>

After token is generated, you can run the CLI commands (you have to append "--profile mfa" to the end of each command to use the token)

    $ aws s3 ls --profile mfa

If you want to generate token as one liner using curl. First get the proper url to the file. To do that click on the file, then click on 'raw' upper right corner. Grab the url. Then execute below command using that url.

    $ curl https://raw.githubusercontent.com/Systems-NYULib/aws-get-mfa-token/main/generate-mfa-cli-token.sh | bash -s <user> <token>
